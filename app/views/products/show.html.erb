<!-- search bar -->
<div class="search-box">
  <%= form_tag products_path, class: "d-flex", method: :get do %>
      <%= text_field_tag :query,
          params[:query],
          class: "form-inline form-control",
          placeholder: "Search by Product name or Certification type" %>
      <%= submit_tag "Search", class: "btn btn-primary" %>
  <% end %>
</div>

<!-- product info -->

<div class="product-container bg-light my-4 p-3 border d-flex align-self-center" >

  <div class="p-2 flex-fill bd-highlight">
    <div id="carouselExampleControls" style="height: 400px; width: 500px; "class="carousel slide" data-ride="carousel">
      
      <div class="carousel-inner">
        <div class="carousel-item active">
          <%= image_tag 'medikit.jpg', size: '500x400', style: 'object-fit: cover;'%>
        </div>

        <div class="carousel-item">
        <%= image_tag 'medikit.jpg', size: '500x400', style: 'object-fit: cover;'%>
        </div>

        <div class="carousel-item">
          <%= image_tag 'medikit.jpg', size: '500x400', style: 'object-fit: cover;'%>
        </div>
      </div>
      
      <a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="sr-only">Previous</span>
      </a>

      <a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="sr-only">Next</span>
      </a>
    </div>
  </div>

  <div class="product-show d-flex flex-column flex-column justify-content-between flex-fill">
    <h1><%= @product.name %></h1>
    <div class="boxes d-flex justify-content-between p-3">
      <div class="box border">
        <h6>$<%= @product.price %>/unit</h6>
        <p><em>Price</em></p>
      </div>

      <div class="box border">
        <h6><%= @product.category %></h6>
        <p><em>Category</em></p>
      </div>
      
      <div class="box border">
        <h6><%= @product.production_quantity %></h6>
        <p><em>Available</em></p>
      </div>

      <div class="box border">
        <h6><%= @product.minimum_order_quantity %></h6>
        <p><em>MOQ</em></p>
      </div>

      <div class="box border">
        <h6><%= @product.supplier.name %></h6>
        <p><em>Supplier</em></p>
      </div>
    </div>

    <div class="button-group d-flex justify-content-between">
      <div class="buttons">
        <button type="button" class="btn btn-supplier" data-toggle="modal" data-target="#exampleModal">
          <%= icon('far', 'envelope') %> Message
        </button>

        <!-- Modal -->
        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
          <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title" id="exampleModalLabel">Write</h5>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
                <div class="modal-body">
                  <%= render 'shared/message_form' %>
                </div>
                <div class="modal-footer">
                  <%# <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                  <button type="button" class="btn btn-primary">Send</button> %>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="buttons">
        <%= link_to "Supplier info", supplier_path(@product.supplier), class: "btn btn-supplier", target: "_blank", rel: "noopener noreferrer"  %>
      </div>

      <div class="buttons">
        <h5><%= link_to "Request quote", new_purchasers_offer_path(product_id: @product.id), class: "btn btn-success", target: "_blank", rel: "noopener noreferrer" %></h5>
      </div>

      <% if policy([:suppliers, @product]).edit? %>
        <div><%= link_to "Edit product", edit_suppliers_product_path(@product), class: "btn btn-supplier" %></div>
      <% end %>

      <% if policy([:suppliers, @product]).destroy? %>
        <div><%= link_to "Destroy product", suppliers_product_path(@product.id), class: "btn btn-danger", method: :delete, data: {confirm: 'Are you sure?'} %></div>
      <% end %>
    </div>
  </div>
</div>


